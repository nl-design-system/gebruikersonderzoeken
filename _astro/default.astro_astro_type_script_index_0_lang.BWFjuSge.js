function A(){return typeof HTMLButtonElement<"u"&&"command"in HTMLButtonElement.prototype&&"source"in((globalThis.CommandEvent||{}).prototype||{})}function S(){document.addEventListener("invoke",e=>{e.type=="invoke"&&e.isTrusted&&(e.stopImmediatePropagation(),e.preventDefault())},!0),document.addEventListener("command",e=>{e.type=="command"&&e.isTrusted&&(e.stopImmediatePropagation(),e.preventDefault())},!0);function v(e,o,t=!0){Object.defineProperty(e,o,{...Object.getOwnPropertyDescriptor(e,o),enumerable:t})}function s(e){return e&&typeof e.getRootNode=="function"?e.getRootNode():e&&e.parentNode?s(e.parentNode):e}const u=new WeakMap,l=new WeakMap;class m extends Event{constructor(o,t={}){super(o,t);const{source:n,command:r}=t;if(n!=null&&!(n instanceof Element))throw new TypeError("source must be an element");u.set(this,n||null),l.set(this,r!==void 0?String(r):"")}get[Symbol.toStringTag](){return"CommandEvent"}get source(){if(!u.has(this))throw new TypeError("illegal invocation");const o=u.get(this);if(!(o instanceof Element))return null;const t=s(o);return t!==s(this.target||document)?t.host:o}get command(){if(!l.has(this))throw new TypeError("illegal invocation");return l.get(this)}get action(){throw new Error("CommandEvent#action was renamed to CommandEvent#command")}get invoker(){throw new Error("CommandEvent#invoker was renamed to CommandEvent#source")}}v(m.prototype,"source"),v(m.prototype,"command");class b extends Event{constructor(o,t={}){throw super(o,t),new Error("InvokeEvent has been deprecated, it has been renamed to `CommandEvent`")}}const c=new WeakMap;function g(e){Object.defineProperties(e.prototype,{commandForElement:{enumerable:!0,configurable:!0,set(o){if(this.hasAttribute("invokeaction"))throw new TypeError("Element has deprecated `invokeaction` attribute, replace with `command`");if(this.hasAttribute("invoketarget"))throw new TypeError("Element has deprecated `invoketarget` attribute, replace with `commandfor`");if(o===null)this.removeAttribute("commandfor"),c.delete(this);else if(o instanceof Element){this.setAttribute("commandfor","");const t=s(o);s(this)===t||t===this.ownerDocument?c.set(this,o):c.delete(this)}else throw new TypeError("commandForElement must be an element or null")},get(){if(this.localName!=="button")return null;if(this.hasAttribute("invokeaction")||this.hasAttribute("invoketarget"))return console.warn("Element has deprecated `invoketarget` or `invokeaction` attribute, use `commandfor` and `command` instead"),null;if(this.disabled)return null;if(this.form&&this.getAttribute("type")!=="button")return console.warn("Element with `commandFor` is a form participant. It should explicitly set `type=button` in order for `commandFor` to work"),null;const o=c.get(this);if(o)return o.isConnected?o:(c.delete(this),null);const t=s(this),n=this.getAttribute("commandfor");return(t instanceof Document||t instanceof ShadowRoot)&&n&&t.getElementById(n)||null}},command:{enumerable:!0,configurable:!0,get(){const o=this.getAttribute("command")||"";if(o.startsWith("--"))return o;const t=o.toLowerCase();switch(t){case"show-modal":case"close":case"toggle-popover":case"hide-popover":case"show-popover":return t}return""},set(o){this.setAttribute("command",o)}},invokeAction:{enumerable:!1,configurable:!0,get(){throw new Error("invokeAction is deprecated. It has been renamed to command")},set(o){throw new Error("invokeAction is deprecated. It has been renamed to command")}},invokeTargetElement:{enumerable:!1,configurable:!0,get(){throw new Error("invokeTargetElement is deprecated. It has been renamed to command")},set(o){throw new Error("invokeTargetElement is deprecated. It has been renamed to command")}}})}const h=new WeakMap;Object.defineProperties(HTMLElement.prototype,{oncommand:{enumerable:!0,configurable:!0,get(){return p.takeRecords(),h.get(this)||null},set(e){const o=h.get(this)||null;o&&this.removeEventListener("command",o),h.set(this,typeof e=="object"||typeof e=="function"?e:null),typeof e=="function"&&this.addEventListener("command",e)}}});function d(e){for(const o of e)o.oncommand=new Function("event",o.getAttribute("oncommand"))}const p=new MutationObserver(e=>{for(const o of e){const{target:t}=o;o.type==="childList"?d(t.querySelectorAll("[oncommand]")):d([t])}});p.observe(document,{subtree:!0,childList:!0,attributeFilter:["oncommand"]}),d(document.querySelectorAll("[oncommand]"));function E(e){if(e.defaultPrevented||e.type!=="click")return;const o=e.target.closest("button[invoketarget], button[invokeaction], input[invoketarget], input[invokeaction]");if(o&&(console.warn("Elements with `invoketarget` or `invokeaction` are deprecated and should be renamed to use `commandfor` and `command` respectively"),o.matches("input")))throw new Error("Input elements no longer support `commandfor`");const t=e.target.closest("button[commandfor], button[command]");if(!t)return;if(t.form&&t.getAttribute("type")!=="button")throw e.preventDefault(),new Error("Element with `commandFor` is a form participant. It should explicitly set `type=button` in order for `commandFor` to work. In order for it to act as a Submit button, it must not have command or commandfor attributes");if(t.hasAttribute("command")!==t.hasAttribute("commandfor")){const i=t.hasAttribute("command")?"command":"commandfor",f=t.hasAttribute("command")?"commandfor":"command";throw new Error(`Element with ${i} attribute must also have a ${f} attribute to function.`)}if(t.command!=="show-popover"&&t.command!=="hide-popover"&&t.command!=="toggle-popover"&&t.command!=="show-modal"&&t.command!=="close"&&!t.command.startsWith("--")){console.warn(`"${t.command}" is not a valid command value. Custom commands must begin with --`);return}const n=t.commandForElement;if(!n)return;const r=new m("command",{command:t.command,source:t,cancelable:!0});if(n.dispatchEvent(r),r.defaultPrevented)return;const a=r.command.toLowerCase();if(n.popover){const i=!n.matches(":popover-open");i&&(a==="toggle-popover"||a==="show-popover")?n.showPopover({source:t}):!i&&a==="hide-popover"&&n.hidePopover()}else if(n.localName==="dialog"){const i=!n.hasAttribute("open");i&&a==="show-modal"?n.showModal():!i&&a==="close"&&n.close()}}function w(e){e.addEventListener("click",E,!0)}function y(e,o){const t=e.prototype.attachShadow;e.prototype.attachShadow=function(r){const a=t.call(this,r);return o(a),a};const n=e.prototype.attachInternals;e.prototype.attachInternals=function(){const r=n.call(this);return r.shadowRoot&&o(r.shadowRoot),r}}g(HTMLButtonElement),y(HTMLElement,e=>{w(e),p.observe(e,{attributeFilter:["oncommand"]}),d(e.querySelectorAll("[oncommand]"))}),w(document),Object.assign(globalThis,{CommandEvent:m,InvokeEvent:b})}A()||S();
