---
import CenterColumnLayout from '@layouts/center-column.astro';
import { BodyCopy } from '@nl-design-system-community/ma-components/local/body-copy/body-copy.tsx';
import { getCollection, render } from 'astro:content';
import { toCleanRoute } from '../../utils/menu';

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const pages = await getCollection('pages').then((pages) =>
    pages.map((page) => {
      const id = toCleanRoute(page.id);
      return { ...page, id };
    }),
  );

  return pages.map((page) => ({
    params: { path: page.id },
    props: { page },
  }));
}

// 2. For your template, you can get the entry directly from the prop
const { page } = Astro.props;
const { Content, remarkPluginFrontmatter } = await render(page);
const cover = page.data.cover ?? remarkPluginFrontmatter['cover'];
---

<CenterColumnLayout title={page.data.title} cover={cover}>
  <BodyCopy large>
    <Content />
  </BodyCopy>
</CenterColumnLayout>
